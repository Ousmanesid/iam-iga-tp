<?xml version="1.0" encoding="UTF-8"?>
<!--
  Role: Home App Admin
  Rôle administrateur pour Home App - nécessite une approbation
  
  Ce rôle provisionne un compte dans Home App avec des droits d'administration.
  L'assignation de ce rôle déclenche un workflow d'approbation via N8N.
-->
<role oid="00000000-0000-0000-0000-000000000102"
      xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
      xmlns:q="http://prism.evolveum.com/xml/ns/public/query-3"
      xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
      xmlns:t="http://prism.evolveum.com/xml/ns/public/types-3"
      xmlns:ri="http://midpoint.evolveum.com/xml/ns/public/resource/instance-3">

    <name>Home App Admin</name>
    <description>Rôle administrateur Home App - Nécessite approbation par le responsable IT</description>
    
    <displayName>Administrateur Home App</displayName>
    
    <requestable>true</requestable>
    <riskLevel>high</riskLevel>

    <!-- Inducement: création du compte dans Home App PostgreSQL -->
    <inducement>
        <construction>
            <resourceRef oid="8a83b1a4-be18-11e6-ae84-7301fdab1d7f" type="ResourceType">
                <!-- Home App PostgreSQL -->
            </resourceRef>
            <kind>account</kind>
            <intent>default</intent>
            
            <!-- Attribut additionnel pour les admins -->
            <attribute>
                <ref>ri:attributes</ref>
                <outbound>
                    <strength>strong</strength>
                    <expression>
                        <value>{"admin_level": "full", "can_manage_users": true}</value>
                    </expression>
                </outbound>
            </attribute>
        </construction>
    </inducement>

    <!-- 
    Note: L'approbation doit être configurée via les workflows MidPoint ou N8N.
    L'élément <approvalSchema> n'est pas supporté dans MidPoint 4.8.
    -->

</role>

